var item;async function sendEmail(e){item.body.getAsync("html",{asyncContext:e},(async function(e){JSON.parse(localStorage.getItem("isEncryptEnable"))?item.getAttachmentsAsync({asyncContext:{currentItem:item}},(async t=>{1===t.value.length?t.value.forEach((async({id:t,name:n})=>{const a=!!localStorage.getItem("isEncrypted")&&localStorage.getItem("isEncrypted");n.includes(".vgar")&&a?(item.body.setAsync(modifyEmail(e.value),{coercionType:"html",asyncContext:"This is passed to the callback"},(function(t){console.log(modifyEmail(e.value)),e.asyncContext.completed({allowEvent:!0})})),localStorage.removeItem("isEncrypted")):(e.asyncContext.completed({allowEvent:!1}),Office.context.mailbox.item.notificationMessages.replaceAsync("action","Can't send the email without sercure file"))})):(e.asyncContext.completed({allowEvent:!1}),Office.context.mailbox.item.notificationMessages.replaceAsync("action","Can't send the email without sercure file"))})):(Office.context.mailbox.item.notificationMessages.replaceAsync("action","Sending the email ..."),item.body.setAsync(e.value,{coercionType:"html",asyncContext:"This is passed to the callback"},(function(t){e.asyncContext.completed({allowEvent:!0})})))}))}function modifyEmail(e){return`<!DOCTYPE html>\n            <html>\n                <head>\n                    <title>EB Control</title>\n                    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet">\n                    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />\n                    <meta content="width=device-width, initial-scale=1.0" name="viewport">\n                    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">\n                </head> \n                ${e} \n            </html>`}Office.onReady((async e=>{item=Office.context.mailbox.item}));